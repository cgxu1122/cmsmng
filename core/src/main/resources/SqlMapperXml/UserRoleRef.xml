<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ifhz.core.mapper.UserRoleRefMapper" >

	<select id="findRoleIdByUserId" resultType="com.ifhz.core.po.UserRoleRef">
		select 
		        id,
		        role_id  as  roleId,
		        user_id  as  userId,
		        create_time as createTime
		from 
				ty_user_role_ref
		where  
		        user_id = #{userId}
	</select>
	
	<delete id="deleteAllRefByRoleId" parameterType="long">
        delete from ty_user_role_ref where role_id=#{roleId}
    </delete>
    
    <delete id="deleteAllRefByUserId" parameterType="long">
        delete from ty_user_role_ref where user_id=#{userId}
    </delete>
    
    <insert id="insert" parameterType="com.ifhz.core.po.UserRoleRef">
		insert into ty_user_role_ref (
            id,
			role_id,
			user_id,
			create_time
		) values(
            SEQ_TY_USER_ROLE_REF.nextval,
			#{roleId},
			#{userId},
			sysdate
		)
        <selectKey resultType="long" keyProperty="id">
            SELECT SEQ_TY_USER_ROLE_REF.CURRVAL FROM DUAL
        </selectKey>
	</insert>
</mapper>