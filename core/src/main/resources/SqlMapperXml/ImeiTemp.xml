<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ifhz.core.mapper.ImeiTempMapper">

    <resultMap id="ImeiResultMap" type="com.ifhz.core.service.imei.bean.DataLogResult">
        <result column="IMEI" property="imei" jdbcType="VARCHAR"/>
        <result column="UA" property="modelName" jdbcType="VARCHAR"/>
        <result column="CHANNEL_ID" property="channelId" jdbcType="BIGINT"/>
        <result column="GROUP_ID" property="groupId" jdbcType="BIGINT"/>
        <result column="PROCESS_TIME" property="processTime" jdbcType="DATE"/>
        <result column="ACTIVE" property="active" jdbcType="INTEGER"/>
    </resultMap>


    <insert id="insertBatch">
        insert into TY_IMEI_TEMP
        <foreach collection="list" item="item" index="index" separator="union all">
            (select #{item,jdbcType=VARCHAR} from dual )
        </foreach>
    </insert>


    <select id="queryListByImeiList" resultMap="ImeiResultMap">
        select
        a.IMEI as IMEI,
        a.UA as UA,
        a.CHANNEL_ID as CHANNEL_ID,
        a.GROUP_ID as GROUP_ID,
        a.PROCESS_TIME as PROCESS_TIME,
        a.ACTIVE as ACTIVE,
        c.CHANNEL_NAME as CHANNEL_NAME
        from ${tableName} a
        inner join TY_IMEI_TEMP b on a.imei = b.imei
        inner join TY_CHANNEL_INFO c on a.CHANNEL_ID = b.CHANNEL_ID
    </select>

</mapper>